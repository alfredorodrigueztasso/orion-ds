{
  "$schema": "https://orion-ds.dev/schema/registry-item.json",
  "name": "command",
  "type": "registry:component",
  "title": "Command",
  "description": "Command component",
  "category": "utilities",
  "files": [
    {
      "path": "packages/react/src/components/Command/Command.tsx",
      "type": "registry:component",
      "content": "/**\n * Command Component\n *\n * A searchable command palette with keyboard navigation.\n * Built without cmdk — uses internal context for search state and filtering.\n *\n * @example\n * ```tsx\n * <Command>\n *   <Command.Input placeholder=\"Type a command...\" />\n *   <Command.List>\n *     <Command.Empty>No results found.</Command.Empty>\n *     <Command.Group heading=\"Suggestions\">\n *       <Command.Item onSelect={() => navigate('/calendar')}>\n *         <CalendarIcon size={16} /> Calendar\n *         <Command.Shortcut>⌘C</Command.Shortcut>\n *       </Command.Item>\n *     </Command.Group>\n *   </Command.List>\n * </Command>\n * ```\n */\n\nimport React, {\n  createContext,\n  useContext,\n  useState,\n  useCallback,\n  useRef,\n  useEffect,\n  useId,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { Search } from 'lucide-react';\nimport { Divider } from '../Divider';\nimport type {\n  CommandProps,\n  CommandDialogProps,\n  CommandInputProps,\n  CommandListProps,\n  CommandEmptyProps,\n  CommandGroupProps,\n  CommandItemProps,\n  CommandSeparatorProps,\n  CommandShortcutProps,\n} from './Command.types';\nimport styles from './Command.module.css';\n\n// ============================================================================\n// CONTEXT\n// ============================================================================\n\ninterface CommandContextValue {\n  search: string;\n  setSearch: (value: string) => void;\n  filter: (value: string, search: string) => number;\n  activeIndex: number;\n  setActiveIndex: (index: number) => void;\n  registerItem: (id: string, value: string) => void;\n  unregisterItem: (id: string) => void;\n  items: Map<string, string>;\n  getVisibleItems: () => string[];\n  listId: string;\n}\n\nconst CommandContext = createContext<CommandContextValue | null>(null);\n\nfunction useCommandContext(): CommandContextValue {\n  const ctx = useContext(CommandContext);\n  if (!ctx) throw new Error('Command compound components must be used within <Command>');\n  return ctx;\n}\n\nconst defaultFilter = (value: string, search: string): number => {\n  if (!search) return 1;\n  return value.toLowerCase().includes(search.toLowerCase()) ? 1 : 0;\n};\n\n// ============================================================================\n// COMMAND ROOT\n// ============================================================================\n\nexport const Command: React.FC<CommandProps> & {\n  Input: React.FC<CommandInputProps>;\n  List: React.FC<CommandListProps>;\n  Empty: React.FC<CommandEmptyProps>;\n  Group: React.FC<CommandGroupProps>;\n  Item: React.FC<CommandItemProps>;\n  Separator: React.FC<CommandSeparatorProps>;\n  Shortcut: React.FC<CommandShortcutProps>;\n  Dialog: React.FC<CommandDialogProps>;\n} = ({ value, onValueChange, filter = defaultFilter, children, className, ...rest }) => {\n  const [internalSearch, setInternalSearch] = useState('');\n  const [activeIndex, setActiveIndex] = useState(0);\n  const itemsRef = useRef(new Map<string, string>());\n  const [, forceUpdate] = useState(0);\n  const listId = useId();\n\n  const search = value !== undefined ? value : internalSearch;\n  const setSearch = useCallback(\n    (v: string) => {\n      if (value !== undefined) {\n        onValueChange?.(v);\n      } else {\n        setInternalSearch(v);\n      }\n      setActiveIndex(0);\n    },\n    [value, onValueChange],\n  );\n\n  const registerItem = useCallback((id: string, itemValue: string) => {\n    itemsRef.current.set(id, itemValue);\n    forceUpdate((n) => n + 1);\n  }, []);\n\n  const unregisterItem = useCallback((id: string) => {\n    itemsRef.current.delete(id);\n    forceUpdate((n) => n + 1);\n  }, []);\n\n  const getVisibleItems = useCallback(() => {\n    const visible: string[] = [];\n    for (const [id, val] of itemsRef.current) {\n      if (filter(val, search) > 0) {\n        visible.push(id);\n      }\n    }\n    return visible;\n  }, [filter, search]);\n\n  const contextValue = useMemo<CommandContextValue>(\n    () => ({\n      search,\n      setSearch,\n      filter,\n      activeIndex,\n      setActiveIndex,\n      registerItem,\n      unregisterItem,\n      items: itemsRef.current,\n      getVisibleItems,\n      listId,\n    }),\n    [\n      search,\n      setSearch,\n      filter,\n      activeIndex,\n      setActiveIndex,\n      registerItem,\n      unregisterItem,\n      getVisibleItems,\n      listId,\n    ],\n  );\n\n  const rootRef = useRef<HTMLDivElement>(null);\n\n  // Keyboard navigation\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      const visible = getVisibleItems();\n      if (!visible.length) return;\n\n      if (e.key === 'ArrowDown') {\n        e.preventDefault();\n        setActiveIndex((prev) => (prev + 1) % visible.length);\n      } else if (e.key === 'ArrowUp') {\n        e.preventDefault();\n        setActiveIndex((prev) => (prev - 1 + visible.length) % visible.length);\n      } else if (e.key === 'Enter') {\n        e.preventDefault();\n        const activeId = visible[activeIndex];\n        if (activeId) {\n          const el = rootRef.current?.querySelector(\n            `[data-command-id=\"${activeId}\"]`,\n          ) as HTMLElement;\n          el?.click();\n        }\n      }\n    },\n    [getVisibleItems, activeIndex, setActiveIndex],\n  );\n\n  const commandClasses = [styles.command, className].filter(Boolean).join(' ');\n\n  return (\n    <CommandContext.Provider value={contextValue}>\n      <div ref={rootRef} className={commandClasses} onKeyDown={handleKeyDown} {...rest}>\n        {children}\n      </div>\n    </CommandContext.Provider>\n  );\n};\n\n// ============================================================================\n// COMMAND.INPUT\n// ============================================================================\n\nconst CommandInput: React.FC<CommandInputProps> = ({ className, ...rest }) => {\n  const { search, setSearch, listId } = useCommandContext();\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  // Auto-focus on mount\n  useEffect(() => {\n    inputRef.current?.focus();\n  }, []);\n\n  const wrapperClasses = [styles.inputWrapper, className].filter(Boolean).join(' ');\n\n  return (\n    <div className={wrapperClasses}>\n      <Search size={16} className={styles.searchIcon} aria-hidden=\"true\" />\n      <input\n        ref={inputRef}\n        className={styles.input}\n        value={search}\n        onChange={(e) => setSearch(e.target.value)}\n        type=\"text\"\n        role=\"combobox\"\n        aria-expanded=\"true\"\n        aria-autocomplete=\"list\"\n        aria-controls={listId}\n        {...rest}\n      />\n    </div>\n  );\n};\n\nCommandInput.displayName = 'Command.Input';\n\n// ============================================================================\n// COMMAND.LIST\n// ============================================================================\n\nconst CommandList: React.FC<CommandListProps> = ({ children, className, ...rest }) => {\n  const { listId } = useCommandContext();\n  const listClasses = [styles.list, className].filter(Boolean).join(' ');\n\n  return (\n    <div id={listId} className={listClasses} role=\"listbox\" {...rest}>\n      {children}\n    </div>\n  );\n};\n\nCommandList.displayName = 'Command.List';\n\n// ============================================================================\n// COMMAND.EMPTY\n// ============================================================================\n\nconst CommandEmpty: React.FC<CommandEmptyProps> = ({ children, className }) => {\n  const { getVisibleItems } = useCommandContext();\n  const visible = getVisibleItems();\n\n  if (visible.length > 0) return null;\n\n  const emptyClasses = [styles.empty, className].filter(Boolean).join(' ');\n  return (\n    <div className={emptyClasses} role=\"status\" aria-live=\"polite\">\n      {children}\n    </div>\n  );\n};\n\nCommandEmpty.displayName = 'Command.Empty';\n\n// ============================================================================\n// COMMAND.GROUP\n// ============================================================================\n\nconst CommandGroup: React.FC<CommandGroupProps> = ({ heading, children, className }) => {\n  const groupClasses = [styles.group, className].filter(Boolean).join(' ');\n\n  return (\n    <div className={groupClasses} role=\"group\" aria-label={heading}>\n      {heading && <div className={styles.groupHeading}>{heading}</div>}\n      {children}\n    </div>\n  );\n};\n\nCommandGroup.displayName = 'Command.Group';\n\n// ============================================================================\n// COMMAND.ITEM\n// ============================================================================\n\nlet itemIdCounter = 0;\n\nconst CommandItem: React.FC<CommandItemProps> = ({\n  onSelect,\n  disabled = false,\n  value: valueProp,\n  children,\n  className,\n  ...rest\n}) => {\n  const { filter, search, activeIndex, getVisibleItems, registerItem, unregisterItem } =\n    useCommandContext();\n\n  const idRef = useRef<string>('');\n  if (!idRef.current) {\n    idRef.current = `cmd-item-${++itemIdCounter}`;\n  }\n  const id = idRef.current;\n\n  // Determine the text value for filtering\n  const textValue = valueProp || extractText(children);\n\n  useEffect(() => {\n    registerItem(id, textValue);\n    return () => unregisterItem(id);\n  }, [id, textValue, registerItem, unregisterItem]);\n\n  const isVisible = filter(textValue, search) > 0;\n  const visibleItems = getVisibleItems();\n  const myIndex = visibleItems.indexOf(id);\n  const isActive = myIndex === activeIndex;\n\n  const handleClick = () => {\n    if (disabled) return;\n    onSelect?.();\n  };\n\n  const itemClasses = [\n    styles.item,\n    disabled && styles.itemDisabled,\n    !isVisible && styles.itemHidden,\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  return (\n    <div\n      className={itemClasses}\n      data-command-id={id}\n      data-active={isActive}\n      role=\"option\"\n      aria-selected={isActive}\n      aria-disabled={disabled}\n      onClick={handleClick}\n      {...rest}\n    >\n      {children}\n    </div>\n  );\n};\n\nCommandItem.displayName = 'Command.Item';\n\n// ============================================================================\n// COMMAND.SEPARATOR\n// ============================================================================\n\nconst CommandSeparator: React.FC<CommandSeparatorProps> = ({ className }) => {\n  const separatorClasses = [styles.separator, className].filter(Boolean).join(' ');\n  return <Divider spacing=\"none\" className={separatorClasses} />;\n};\n\nCommandSeparator.displayName = 'Command.Separator';\n\n// ============================================================================\n// COMMAND.SHORTCUT\n// ============================================================================\n\nconst CommandShortcut: React.FC<CommandShortcutProps> = ({ children, className }) => {\n  const shortcutClasses = [styles.shortcut, className].filter(Boolean).join(' ');\n  return <span className={shortcutClasses}>{children}</span>;\n};\n\nCommandShortcut.displayName = 'Command.Shortcut';\n\n// ============================================================================\n// COMMAND.DIALOG\n// ============================================================================\n\nconst CommandDialog: React.FC<CommandDialogProps> = ({\n  open,\n  onOpenChange,\n  children,\n  className,\n}) => {\n  // Handle escape\n  useEffect(() => {\n    if (!open) return;\n\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onOpenChange(false);\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [open, onOpenChange]);\n\n  // Body scroll lock\n  useEffect(() => {\n    if (open) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [open]);\n\n  if (!open) return null;\n\n  const handleBackdropClick = (e: React.MouseEvent) => {\n    if (e.target === e.currentTarget) {\n      onOpenChange(false);\n    }\n  };\n\n  return createPortal(\n    <div className={styles.dialogBackdrop} onClick={handleBackdropClick}>\n      <div className={[styles.dialogContent, className].filter(Boolean).join(' ')}>\n        <Command>{children}</Command>\n      </div>\n    </div>,\n    document.body,\n  );\n};\n\nCommandDialog.displayName = 'Command.Dialog';\n\n// ============================================================================\n// ATTACH SUB-COMPONENTS\n// ============================================================================\n\nCommand.Input = CommandInput;\nCommand.List = CommandList;\nCommand.Empty = CommandEmpty;\nCommand.Group = CommandGroup;\nCommand.Item = CommandItem;\nCommand.Separator = CommandSeparator;\nCommand.Shortcut = CommandShortcut;\nCommand.Dialog = CommandDialog;\nCommand.displayName = 'Command';\n\n// ============================================================================\n// HELPERS\n// ============================================================================\n\n/**\n * Extract text content from React children for filtering.\n */\nfunction extractText(children: React.ReactNode): string {\n  if (typeof children === 'string') return children;\n  if (typeof children === 'number') return String(children);\n  if (Array.isArray(children)) return children.map(extractText).join(' ');\n  if (React.isValidElement(children) && children.props) {\n    return extractText((children.props as { children?: React.ReactNode }).children);\n  }\n  return '';\n}\n"
    },
    {
      "path": "packages/react/src/components/Command/Command.types.ts",
      "type": "registry:types",
      "content": "/**\n * Command Component Types\n *\n * Type definitions for the Orion Command palette component.\n * A searchable command menu with keyboard navigation.\n */\n\nimport type { HTMLAttributes, ReactNode, InputHTMLAttributes } from 'react';\n\n/**\n * Command root props\n */\nexport interface CommandProps extends Omit<HTMLAttributes<HTMLDivElement>, 'onSelect'> {\n  /**\n   * Controlled search value\n   */\n  value?: string;\n\n  /**\n   * Callback when search value changes\n   */\n  onValueChange?: (value: string) => void;\n\n  /**\n   * Custom filter function. Return 0 to hide, 1 to show.\n   * By default uses case-insensitive includes.\n   */\n  filter?: (value: string, search: string) => number;\n\n  /**\n   * Children (compound components)\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Dialog props — renders Command inside a modal overlay\n */\nexport interface CommandDialogProps {\n  /**\n   * Whether the dialog is open\n   */\n  open: boolean;\n\n  /**\n   * Callback when open state changes\n   */\n  onOpenChange: (open: boolean) => void;\n\n  /**\n   * Children (Command compound components)\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Input props\n */\nexport interface CommandInputProps extends Omit<\n  InputHTMLAttributes<HTMLInputElement>,\n  'onChange' | 'value'\n> {\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.List props\n */\nexport interface CommandListProps extends HTMLAttributes<HTMLDivElement> {\n  /**\n   * Children (groups and items)\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Empty props\n */\nexport interface CommandEmptyProps {\n  /**\n   * Content to show when no results match\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Group props\n */\nexport interface CommandGroupProps {\n  /**\n   * Group heading\n   */\n  heading?: string;\n\n  /**\n   * Group items\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Item props\n */\nexport interface CommandItemProps extends Omit<HTMLAttributes<HTMLDivElement>, 'onSelect'> {\n  /**\n   * Callback when item is selected (click or Enter)\n   */\n  onSelect?: () => void;\n\n  /**\n   * Whether the item is disabled\n   * @default false\n   */\n  disabled?: boolean;\n\n  /**\n   * Search value for filtering (defaults to text content)\n   */\n  value?: string;\n\n  /**\n   * Children\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Separator props\n */\nexport interface CommandSeparatorProps {\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n\n/**\n * Command.Shortcut props\n */\nexport interface CommandShortcutProps {\n  /**\n   * Keyboard shortcut text\n   */\n  children?: ReactNode;\n\n  /**\n   * Additional class name\n   */\n  className?: string;\n}\n"
    },
    {
      "path": "packages/react/src/components/Command/Command.module.css",
      "type": "registry:styles",
      "content": "/**\n * Command Component Styles\n *\n * Command palette with search, groups, and keyboard navigation.\n */\n\n/* Root container */\n.command {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  overflow: hidden;\n  background: var(--surface-base);\n  border: 1px solid var(--border-subtle);\n  border-radius: var(--radius-container);\n  font-family: var(--font-secondary);\n}\n\n/* ============================================================================\n * INPUT\n * ============================================================================ */\n\n.inputWrapper {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-2);\n  padding: var(--spacing-3) var(--spacing-4);\n  border-bottom: 1px solid var(--border-subtle);\n}\n\n.searchIcon {\n  color: var(--text-tertiary);\n  flex-shrink: 0;\n}\n\n.input {\n  flex: 1;\n  border: none;\n  outline: none;\n  background: transparent;\n  font-family: var(--font-secondary);\n  font-size: var(--font-size-14);\n  color: var(--text-primary);\n  padding: 0;\n}\n\n.input::placeholder {\n  color: var(--text-tertiary);\n}\n\n/* ============================================================================\n * LIST\n * ============================================================================ */\n\n.list {\n  max-height: 300px;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: var(--spacing-2);\n}\n\n/* ============================================================================\n * EMPTY STATE\n * ============================================================================ */\n\n.empty {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: var(--spacing-6);\n  font-size: var(--font-size-14);\n  color: var(--text-tertiary);\n}\n\n/* ============================================================================\n * GROUP\n * ============================================================================ */\n\n.group {\n  padding: var(--spacing-1) 0;\n}\n\n.groupHeading {\n  padding: var(--spacing-1) var(--spacing-2);\n  font-size: var(--font-size-12);\n  font-weight: var(--font-weight-medium);\n  color: var(--text-tertiary);\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n/* ============================================================================\n * ITEM\n * ============================================================================ */\n\n.item {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-2);\n  padding: var(--spacing-2) var(--spacing-2);\n  border-radius: var(--radius-sm);\n  font-size: var(--font-size-14);\n  color: var(--text-primary);\n  cursor: pointer;\n  transition: background var(--transition-fast);\n  position: relative;\n  user-select: none;\n}\n\n.item:hover:not(.itemDisabled) {\n  background: var(--interactive-ghost-hover);\n}\n\n.item[data-active='true'] {\n  background: var(--interactive-ghost-hover);\n}\n\n.item:focus-visible {\n  outline: 2px solid var(--interactive-primary);\n  outline-offset: -2px;\n}\n\n.itemDisabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  pointer-events: none;\n}\n\n.itemHidden {\n  display: none;\n}\n\n/* ============================================================================\n * SEPARATOR\n * ============================================================================ */\n\n/* Override Divider margins within Command context */\n.separator {\n  margin: var(--spacing-1) calc(var(--spacing-2) * -1);\n}\n\n/* ============================================================================\n * SHORTCUT BADGE\n * ============================================================================ */\n\n.shortcut {\n  margin-left: auto;\n  font-size: var(--font-size-12);\n  color: var(--text-tertiary);\n  font-family: var(--font-secondary);\n  letter-spacing: 0.02em;\n  pointer-events: none;\n}\n\n/* ============================================================================\n * DIALOG OVERLAY\n * ============================================================================ */\n\n.dialogBackdrop {\n  position: fixed;\n  inset: 0;\n  z-index: var(--z-modal-backdrop);\n  display: flex;\n  align-items: flex-start;\n  justify-content: center;\n  padding-top: 20vh;\n  background: var(--surface-overlay);\n  backdrop-filter: blur(var(--blur-sm));\n  animation: fadeIn 150ms ease;\n}\n\n.dialogContent {\n  width: 100%;\n  max-width: 520px;\n  animation: slideDown 150ms ease;\n}\n\n.dialogContent .command {\n  box-shadow: var(--shadow-xl);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-8px) scale(0.98);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n/* ============================================================================\n * REDUCED MOTION\n * ============================================================================ */\n\n@media (prefers-reduced-motion: reduce) {\n  .item {\n    transition: none;\n  }\n\n  .dialogBackdrop,\n  .dialogContent {\n    animation: none;\n  }\n}\n"
    },
    {
      "path": "packages/react/src/components/Command/index.ts",
      "type": "registry:index",
      "content": "/**\n * Command Component - Searchable command palette with keyboard navigation.\n *\n * @example\n * ```tsx\n * import { Command } from '@orion-ds/react';\n *\n * <Command>\n *   <Command.Input placeholder=\"Type a command...\" />\n *   <Command.List>\n *     <Command.Empty>No results found.</Command.Empty>\n *     <Command.Group heading=\"Suggestions\">\n *       <Command.Item onSelect={() => {}}>Calendar</Command.Item>\n *     </Command.Group>\n *   </Command.List>\n * </Command>\n * ```\n */\nexport { Command } from './Command';\nexport type {\n  CommandProps,\n  CommandDialogProps,\n  CommandInputProps,\n  CommandListProps,\n  CommandEmptyProps,\n  CommandGroupProps,\n  CommandItemProps,\n  CommandSeparatorProps,\n  CommandShortcutProps,\n} from './Command.types';\n"
    }
  ],
  "props": [
    {
      "name": "value",
      "type": "string",
      "description": "Controlled search value"
    },
    {
      "name": "onValueChange",
      "type": "(value: string) => void",
      "description": "Callback when search value changes"
    },
    {
      "name": "filter",
      "type": "(value: string, search: string) => number",
      "description": "Custom filter function. Return 0 to hide, 1 to show."
    },
    {
      "name": "className",
      "type": "string",
      "description": "Additional class name"
    }
  ],
  "modeAware": false,
  "preview": {
    "url": "https://orion-ds.dev/library.html#command",
    "local": "/library.html#command"
  },
  "import": "import { Command } from '@orion-ds/react'",
  "cssImport": "import '@orion-ds/react/styles.css'"
}
