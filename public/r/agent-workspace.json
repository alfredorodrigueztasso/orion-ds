{
  "$schema": "https://orion-ds.dev/schema/registry-item.json",
  "name": "agent-workspace",
  "type": "registry:template",
  "title": "Agent Workspace",
  "description": "AgentWorkspace page template",
  "category": "app",
  "files": [
    {
      "path": "packages/react/src/templates/app/AgentWorkspace/AgentWorkspace.tsx",
      "type": "registry:component",
      "content": "/**\n * AgentWorkspace\n *\n * Full page template for managing AI agents organized in collapsible folders and ungrouped agents.\n * Supports native HTML5 drag & drop between folders with rich visual feedback, sorting, and folder management.\n *\n * ## Drag & Drop System\n * Uses a hybrid approach combining:\n * - **@dnd-kit/core**: Provides DragOverlay for visual ghost card while dragging\n * - **Native HTML5 DnD**: AgentFolder implements native onDragOver/onDrop for responsive feedback\n *\n * ## Features\n * - **Drop target visual feedback**: Folders highlight when dragging agents over them\n * - **Dynamic insertion indicators**: Blue line shows exact drop position within folder\n * - **Real-time state updates**: Agents move between folders with state synchronization\n * - **Automatic cleanup**: Visual states reset after drop or when leaving folder\n * - **Workspace management**: Dropdown selector for switching between workspaces\n * - **Folder sorting**: Per-folder sort options\n * - **Loose agents**: Agents not assigned to any folder\n *\n * ## State Management\n * Parent component should implement:\n * - `onDrop` handler for each folder to move agents: `(agentId, targetFolderId, insertionIndex?) => void`\n * - State management for folders and their agents\n * - Optional: workspace switching, folder CRUD operations\n *\n * @example\n * ```tsx\n * const [folders, setFolders] = useState(initialFolders);\n *\n * const handleDrop = (agentId: string, targetFolderId: string, index?: number) => {\n *   setFolders(prev => {\n *     // Find source folder containing agent\n *     // Remove agent from source, add to target at specified index\n *     // Update agentCount in both folders\n *   });\n * };\n *\n * <AgentWorkspace\n *   navbar={{\n *     logo: <img src=\"/logo.svg\" alt=\"Logo\" />,\n *     workspaceName: 'My Workspace',\n *     userAvatar: '/avatar.jpg',\n *     userName: 'John Doe'\n *   }}\n *   pageHeader={{\n *     title: 'AI Agents',\n *     icon: <Bot size={24} />\n *   }}\n *   folders={folders.map(folder => ({\n *     ...folder,\n *     onDrop: (agentId, folderId, index) => handleDrop(agentId, folderId, index)\n *   }))}\n *   looseAgents={agentsWithoutFolder}\n *   enableDragDrop={true}\n * />\n * ```\n */\n\nimport React, { useState } from \"react\";\nimport type { AgentWorkspaceProps, DragEndEvent } from \"./AgentWorkspace.types\";\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  useSensor,\n  useSensors,\n} from \"@dnd-kit/core\";\nimport { Navbar } from \"../../../components/Navbar\";\nimport { PageHeader } from \"../../../sections/PageHeader\";\nimport { AgentFolder } from \"../../../sections/AgentFolder\";\nimport { AgentCard } from \"../../../components/AgentCard\";\nimport { Button } from \"../../../components/Button\";\nimport { Popover } from \"../../../components/Popover\";\nimport { Avatar } from \"../../../components/Avatar\";\nimport { Divider } from \"../../../components/Divider\";\nimport {\n  FolderPlus,\n  Plus,\n  ChevronDown,\n  Sparkles,\n  Settings,\n  Users,\n  Bot,\n} from \"lucide-react\";\nimport styles from \"./AgentWorkspace.module.css\";\n\nexport const AgentWorkspace: React.FC<AgentWorkspaceProps> = ({\n  navbar,\n  pageHeader,\n  folders = [],\n  looseAgents,\n  onCreateFolder,\n  onCreateAgent,\n  onInviteParticipants,\n  onSettings,\n  emptyState,\n  enableDragDrop = true,\n  className,\n  ...rest\n}) => {\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [overId, setOverId] = useState<string | null>(null);\n  const [completedFolderId, setCompletedFolderId] = useState<string | null>(\n    null,\n  );\n\n  // Drag & drop sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 8, // 8px movement required to start drag\n      },\n    }),\n  );\n\n  // Find the active agent being dragged\n  const activeAgent = folders\n    ?.flatMap((folder) => folder.agents)\n    .find((agent) => agent.id === activeId);\n\n  // Handle drag start\n  const handleDragStart = (event: { active: { id: string | number } }) => {\n    setActiveId(String(event.active.id));\n  };\n\n  // Handle drag over (to show drop target visual)\n  const handleDragOver = (event: { over: { id: string | number } | null }) => {\n    setOverId(event.over ? String(event.over.id) : null);\n  };\n\n  // Handle drag end\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event;\n\n    if (!over) {\n      setActiveId(null);\n      setOverId(null);\n      return;\n    }\n\n    const agentId = String(active.id);\n    const targetFolderId = String(over.id);\n\n    // Find the folder that contains this agent\n    const sourceFolder = folders?.find((folder) =>\n      folder.agents.some((agent) => agent.id === agentId),\n    );\n\n    // Find the target folder\n    const targetFolder = folders?.find(\n      (folder) => folder.id === targetFolderId,\n    );\n\n    // If dropping into a different folder, set visual feedback\n    // The actual drop handler is managed by AgentFolder's native onDrop with insertion index\n    if (sourceFolder && targetFolder && sourceFolder.id !== targetFolder.id) {\n      // Set completed feedback\n      setCompletedFolderId(targetFolderId);\n      setTimeout(() => setCompletedFolderId(null), 600);\n    }\n\n    setActiveId(null);\n    setOverId(null);\n  };\n\n  // Build page header actions with create buttons\n  const headerActions = (\n    <div className={styles.headerActions}>\n      {onCreateFolder && (\n        <div className={styles.hideOnMobile}>\n          <Button\n            variant=\"secondary\"\n            icon={<FolderPlus size={20} />}\n            onClick={onCreateFolder}\n          >\n            Nueva carpeta\n          </Button>\n        </div>\n      )}\n      {onCreateAgent && (\n        <Button\n          variant=\"primary\"\n          icon={<Plus size={20} />}\n          onClick={onCreateAgent}\n        >\n          Nuevo agente\n        </Button>\n      )}\n      {pageHeader?.actions}\n    </div>\n  );\n\n  const classNames = [styles.template, className].filter(Boolean).join(\" \");\n\n  return (\n    <div className={classNames} {...rest}>\n      {/* Navbar */}\n      {navbar && (\n        <Navbar sticky bordered>\n          {navbar.workspaces && navbar.workspaces.length > 0 && (\n            <div className={styles.workspaceSelector}>\n              <Popover\n                trigger={\n                  <button className={styles.workspaceButton}>\n                    {(navbar.workspaceAvatar ||\n                      navbar.workspaceIcon ||\n                      navbar.workspaceInitials) && (\n                      <Avatar\n                        size=\"xs\"\n                        src={navbar.workspaceAvatar}\n                        icon={navbar.workspaceIcon}\n                        initials={navbar.workspaceInitials}\n                      />\n                    )}\n                    {navbar.workspaceName || \"Workspace\"}\n                    <ChevronDown size={16} />\n                  </button>\n                }\n                content={\n                  <div className={styles.workspacePanel}>\n                    {/* Header: workspace count */}\n                    {navbar.workspaces.length > 0 && (\n                      <div className={styles.workspacePanelCount}>\n                        {navbar.workspaces.length} Organizaciones\n                      </div>\n                    )}\n\n                    {/* Active workspace section */}\n                    <div className={styles.workspacePanelActive}>\n                      <Avatar\n                        size=\"lg\"\n                        src={navbar.workspaceAvatar}\n                        icon={navbar.workspaceIcon}\n                        initials={navbar.workspaceInitials}\n                      />\n                      <div className={styles.workspacePanelInfo}>\n                        <div className={styles.workspacePanelName}>\n                          {navbar.workspaceName || \"Workspace\"}\n                        </div>\n                        {navbar.workspaceRole && (\n                          <div className={styles.workspacePanelMeta}>\n                            {navbar.workspaceRole}\n                          </div>\n                        )}\n                        {navbar.workspaceParticipantCount !== undefined && (\n                          <div className={styles.workspacePanelMeta}>\n                            {navbar.workspaceParticipantCount} participantes\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    {/* Action buttons */}\n                    {(navbar.onWorkspaceSettings ||\n                      navbar.onWorkspaceInvite) && (\n                      <div className={styles.workspacePanelActions}>\n                        {navbar.onWorkspaceSettings && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            icon={<Settings size={16} />}\n                            onClick={navbar.onWorkspaceSettings}\n                          >\n                            Configuración\n                          </Button>\n                        )}\n                        {navbar.onWorkspaceInvite && (\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            icon={<Users size={16} />}\n                            onClick={navbar.onWorkspaceInvite}\n                          >\n                            Participantes\n                          </Button>\n                        )}\n                      </div>\n                    )}\n\n                    {/* Divider and list of other workspaces */}\n                    {navbar.workspaces.length > 1 && (\n                      <>\n                        <div className={styles.workspacePanelDivider}>\n                          <Divider />\n                        </div>\n\n                        <div className={styles.workspacePanelList}>\n                          {navbar.workspaces\n                            .filter(\n                              (ws) =>\n                                !navbar.activeWorkspaceId ||\n                                ws.id !== navbar.activeWorkspaceId,\n                            )\n                            .map((workspace) => (\n                              <div\n                                key={workspace.id}\n                                className={styles.workspaceListItem}\n                                onClick={() =>\n                                  navbar.onWorkspaceChange?.(workspace.id)\n                                }\n                              >\n                                <Avatar\n                                  size=\"xs\"\n                                  src={workspace.avatar}\n                                  icon={workspace.icon}\n                                  initials={workspace.initials}\n                                />\n                                <div className={styles.workspaceListItemInfo}>\n                                  <div className={styles.workspaceListItemName}>\n                                    {workspace.name}\n                                  </div>\n                                  {workspace.role && (\n                                    <div\n                                      className={styles.workspaceListItemRole}\n                                    >\n                                      {workspace.role}\n                                    </div>\n                                  )}\n                                </div>\n                              </div>\n                            ))}\n                        </div>\n                      </>\n                    )}\n\n                    {/* Footer: create workspace */}\n                    <div className={styles.workspacePanelFooter}>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        icon={<Plus size={16} />}\n                        onClick={navbar.onCreateWorkspace}\n                      >\n                        Nueva organización\n                      </Button>\n                    </div>\n                  </div>\n                }\n                placement=\"bottom-start\"\n                showArrow={false}\n              />\n            </div>\n          )}\n\n          <Navbar.Nav>\n            <Navbar.Link href=\"#\" active>\n              Agentes IA\n            </Navbar.Link>\n            <Navbar.Link href=\"#\">Centro atención</Navbar.Link>\n          </Navbar.Nav>\n\n          <Navbar.Actions>\n            {navbar.userAvatar ? (\n              <button\n                className={styles.userButton}\n                onClick={navbar.onUserMenuClick}\n                aria-label=\"User menu\"\n              >\n                <Avatar\n                  src={navbar.userAvatar}\n                  alt={navbar.userName || \"User\"}\n                  size=\"sm\"\n                />\n              </button>\n            ) : (\n              <Avatar\n                initials={navbar.userName?.slice(0, 2).toUpperCase() || \"U\"}\n                size=\"sm\"\n              />\n            )}\n          </Navbar.Actions>\n        </Navbar>\n      )}\n\n      {/* Main Content */}\n      <main className={styles.content}>\n        {/* Page Header */}\n        <PageHeader\n          title={\n            <div className={styles.titleWithIcon}>\n              <span className={styles.titleIcon}>\n                {pageHeader?.icon || <Sparkles size={28} />}\n              </span>\n              <span>{pageHeader?.title || \"Agentes IA\"}</span>\n            </div>\n          }\n          actions={headerActions}\n          bordered={false}\n          variant=\"transparent\"\n          className={styles.pageHeaderInContent}\n        />\n\n        {folders.length === 0 && (!looseAgents || looseAgents.length === 0) ? (\n          // Empty state\n          <div className={styles.emptyState}>\n            {emptyState || (\n              <>\n                <Bot size={64} className={styles.emptyIcon} />\n                <h3 className={styles.emptyTitle}>No hay carpetas todavía</h3>\n                <p className={styles.emptyDescription}>\n                  Crea tu primera carpeta para organizar tus agentes de IA\n                </p>\n                {onCreateFolder && (\n                  <Button\n                    variant=\"primary\"\n                    icon={<FolderPlus size={20} />}\n                    onClick={onCreateFolder}\n                  >\n                    Crear primera carpeta\n                  </Button>\n                )}\n              </>\n            )}\n          </div>\n        ) : enableDragDrop ? (\n          // Drag & drop enabled\n          <DndContext\n            sensors={sensors}\n            onDragStart={handleDragStart}\n            onDragOver={handleDragOver}\n            onDragEnd={handleDragEnd}\n          >\n            <div className={styles.folders}>\n              {folders.map((folder) => (\n                <AgentFolder\n                  key={folder.id}\n                  {...folder}\n                  isDropTarget={overId === folder.id}\n                  isDropCompleted={completedFolderId === folder.id}\n                  onDrop={(agentId, targetFolderId, insertionIndex) => {\n                    // Call the parent handler to move the agent\n                    folder.onDrop?.(agentId, targetFolderId, insertionIndex);\n                  }}\n                  agents={folder.agents.map((agent) => ({\n                    ...agent,\n                    draggable: true,\n                    isDragging: agent.id === activeId,\n                    availableFolders: folders\n                      ?.filter((f) => f.id !== folder.id)\n                      .map((f) => ({ id: f.id, title: f.title })),\n                    onMoveToFolder: (targetFolderId: string) => {\n                      const targetFolder = folders?.find(\n                        (f) => f.id === targetFolderId,\n                      );\n                      targetFolder?.onDrop?.(agent.id, targetFolderId);\n                    },\n                  }))}\n                />\n              ))}\n            </div>\n\n            {/* Drag overlay (ghost card being dragged) */}\n            <DragOverlay dropAnimation={{ duration: 150, easing: \"ease-out\" }}>\n              {activeId && activeAgent ? (\n                <div style={{ transform: \"rotate(2deg)\", cursor: \"grabbing\" }}>\n                  <AgentCard {...activeAgent} isDragging />\n                </div>\n              ) : null}\n            </DragOverlay>\n          </DndContext>\n        ) : (\n          // No drag & drop\n          <div className={styles.folders}>\n            {folders.map((folder) => (\n              <AgentFolder\n                key={folder.id}\n                {...folder}\n                agents={folder.agents.map((agent) => ({\n                  ...agent,\n                  availableFolders: folders\n                    ?.filter((f) => f.id !== folder.id)\n                    .map((f) => ({ id: f.id, title: f.title })),\n                  onMoveToFolder: (targetFolderId: string) => {\n                    const targetFolder = folders?.find(\n                      (f) => f.id === targetFolderId,\n                    );\n                    targetFolder?.onDrop?.(agent.id, targetFolderId);\n                  },\n                }))}\n              />\n            ))}\n          </div>\n        )}\n\n        {/* Loose agents (agents without folder) */}\n        {looseAgents && looseAgents.length > 0 && (\n          <div className={styles.looseAgentsSection}>\n            <Divider label=\"Sin carpeta\" spacing=\"lg\" />\n            <div className={styles.looseAgentsGrid}>\n              {looseAgents.map((agent) => (\n                <div\n                  key={agent.id}\n                  draggable={enableDragDrop && agent.draggable}\n                >\n                  <AgentCard\n                    {...agent}\n                    availableFolders={folders?.map((f) => ({\n                      id: f.id,\n                      title: f.title,\n                    }))}\n                    onMoveToFolder={(targetFolderId: string) => {\n                      const targetFolder = folders?.find(\n                        (f) => f.id === targetFolderId,\n                      );\n                      targetFolder?.onDrop?.(agent.id, targetFolderId);\n                    }}\n                  />\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n};\n\nAgentWorkspace.displayName = \"AgentWorkspace\";\n"
    }
  ],
  "preview": {
    "url": "https://orion-ds.dev/library.html#agent-workspace",
    "local": "/library.html#agent-workspace"
  },
  "import": "import { AgentWorkspace } from '@orion-ds/react'",
  "cssImport": "import '@orion-ds/react/styles.css'"
}
